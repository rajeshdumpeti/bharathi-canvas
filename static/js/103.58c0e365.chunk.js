"use strict";(self.webpackChunkmy_app_=self.webpackChunkmy_app_||[]).push([[103],{4024:(e,t,n)=>{n.d(t,{A:()=>r});var s=n(5043),l=n(579);const r=e=>{let{value:t,onChange:n,placeholder:r="Add and press Enter",className:a="",dedupe:o=!0}=e;const[i,d]=(0,s.useState)(""),c=(0,s.useRef)(null),u=e=>{const s=e.split(/[,;]/g).map(e=>e.trim()).filter(Boolean);if(!s.length)return;const l=new Set(t),r=o?[...new Set([...t,...s])]:[...t,...s];(r.length!==t.length||s.some(e=>!l.has(e)))&&n(r),d("")};return(0,l.jsxs)("div",{className:["flex flex-wrap gap-2 rounded border bg-white px-2 py-2",a].join(" "),onClick:()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.focus()},children:[t.map((e,s)=>(0,l.jsxs)("span",{className:"inline-flex items-center gap-1 rounded-full bg-gray-100 px-2 py-0.5 text-xs text-gray-800",children:[e,(0,l.jsx)("button",{type:"button","aria-label":"Remove ".concat(e),className:"rounded p-0.5 hover:bg-gray-200",onClick:()=>(e=>{var s;const l=t.filter((t,n)=>n!==e);n(l),null===(s=c.current)||void 0===s||s.focus()})(s),children:"\u2715"})]},"".concat(e,"-").concat(s))),(0,l.jsx)("input",{ref:c,value:i,onChange:e=>d(e.target.value),onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),u(i)):"Backspace"===e.key&&!i&&t.length?n(t.slice(0,-1)):","!==e.key&&";"!==e.key||(e.preventDefault(),u(i))},onBlur:()=>(e=>{const s=e.trim();if(!s)return;const l=o?Array.from(new Set([...t,s])):[...t,s];n(l),d("")})(i),placeholder:t.length?"":r,className:"min-w-[8ch] flex-1 outline-none text-sm placeholder:text-gray-400 bg-transparent"})]})}},5107:(e,t,n)=>{n.d(t,{A:()=>l});n(5043);var s=n(579);const l=e=>{let{children:t,onClick:n,type:l="button",className:r="",title:a,disabled:o}=e;return(0,s.jsx)("button",{type:l,title:a,disabled:o,onClick:n,className:["inline-flex items-center gap-1 rounded border px-3 py-1.5 text-sm","bg-white hover:bg-gray-50 text-gray-700","disabled:opacity-60 disabled:cursor-not-allowed",r].join(" "),children:t})}},6041:(e,t,n)=>{n.d(t,{A:()=>l});n(5043);var s=n(579);const l=e=>{let{isOpen:t,onClose:n,title:l,children:r,className:a="bg-white rounded-xl shadow-lg p-6",closeOnBackdrop:o=!0}=e;return t?(0,s.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-black/50",onClick:o?n:void 0}),(0,s.jsx)("div",{className:"absolute left-1/2 top-20 -translate-x-1/2 w-full max-w-lg",children:(0,s.jsxs)("div",{className:"relative bg-white rounded-xl shadow-lg max-h-[90vh] md:max-h-[80vh] overflow-y-auto ".concat(a),role:"dialog","aria-modal":!0,children:[l&&(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:l}),(0,s.jsx)("button",{"aria-label":"Close modal",onClick:n,className:"rounded p-1 hover:bg-gray-100",children:"\u2715"})]}),r]})})]}):null}},6103:(e,t,n)=>{n.r(t),n.d(t,{default:()=>S});var s=n(5043),l=n(6369),r=n(4131),a=n(4893),o=n(8424);const i={getItem:e=>{var t;return null!==(t=localStorage.getItem("".concat(o._w,":").concat(e)))&&void 0!==t?t:null},setItem:(e,t)=>localStorage.setItem("".concat(o._w,":").concat(e),t),removeItem:e=>localStorage.removeItem("".concat(o._w,":").concat(e))},d=(0,a.KU)(()=>i),c=["application/pdf","text/plain","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],u=e=>/\.(pdf|txt|docx)$/i.test(e);function m(e){return new Promise((t,n)=>{const s=new FileReader;if("text/plain"===e.type||/\.txt$/i.test(e.name))return s.onload=()=>{var e;return t({kind:"txt",text:String(null!==(e=s.result)&&void 0!==e?e:"")})},s.onerror=n,void s.readAsText(e);s.onload=()=>{var e;return t({kind:"data",dataURL:String(null!==(e=s.result)&&void 0!==e?e:"")})},s.onerror=n,s.readAsDataURL(e)})}const x=(0,r.v)()((0,a.Zr)((e,t)=>({items:[],selectedId:null,pending:[],error:"",setSelected:t=>e(e=>e.selectedId===t?e:{selectedId:t}),clearSelectedIfDeleted:n=>{const{selectedId:s,items:l}=t();if(s===n){var r,a;const t=null!==(r=null===(a=l.find(e=>e.id!==n))||void 0===a?void 0:a.id)&&void 0!==r?r:null;e({selectedId:t})}},stageFiles:n=>{if(null===n||void 0===n||!n.length)return;const s=t().pending,l=e=>"".concat(e.name,"-").concat(e.size),r=new Set(s.map(l)),a=[...s];n.forEach(e=>{r.has(l(e))||a.push(e)}),e({pending:a,error:""})},clearPending:()=>e({pending:[]}),setError:t=>e({error:t}),clearError:()=>e({error:""}),addDocuments:async n=>{if(null!==n&&void 0!==n&&n.length){for(const t of n){if(t.size>5242880)return void e({error:'"'.concat(t.name,'" is larger than 5 MB.')});if(!c.includes(t.type)&&!u(t.name))return void e({error:'"'.concat(t.name,'" is not a supported type (PDF, DOCX, TXT).')})}try{var s,l,r;const a=(await Promise.all(n.map(m))).map((e,t)=>{var s;const l=n[t];return{id:"".concat(Date.now(),"-").concat(t,"-").concat(Math.random().toString(36).slice(2,7)),name:l.name,type:l.type||((null===(s=l.name.match(/\.(\w+)$/))||void 0===s?void 0:s[1])||"").toLowerCase(),size:l.size,createdAt:(new Date).toISOString(),dataURL:"data"===e.kind?e.dataURL:null,text:"txt"===e.kind?e.text:null}}),o=[...t().items,...a],i=null!==(s=null!==(l=t().selectedId)&&void 0!==l?l:null===(r=o[0])||void 0===r?void 0:r.id)&&void 0!==s?s:null;e({items:o,selectedId:i,pending:[],error:""})}catch(a){console.error(a),e({error:"Failed to read one or more files."})}}},deleteDocument:t=>e(e=>{var n,s;const l=e.items.filter(e=>e.id!==t.id),r=e.selectedId===t.id?null!==(n=null===(s=l[0])||void 0===s?void 0:s.id)&&void 0!==n?n:null:e.selectedId;return l===e.items&&r===e.selectedId?e:{items:l,selectedId:r}})}),{name:"".concat(o._w,":store"),version:1,storage:d,partialize:e=>({items:e.items,selectedId:e.selectedId})}));var p=n(9379),h=n(4858),f=n(579);const g=()=>{const e=(0,s.useRef)(null),[t,n]=(0,s.useState)(!1),l=x(e=>e.pending),r=x(e=>e.error),a=x(e=>e.stageFiles),o=x(e=>e.clearPending),i=x(e=>e.setError),d=x(e=>e.clearError),c=x(e=>e.addDocuments),{register:u,handleSubmit:m,setValue:g}=(0,h.mN)({defaultValues:{files:null}}),v=u("files"),b=e=>{null!==e&&void 0!==e&&e.length&&(d(),a(Array.from(e)),g("files",e))};return(0,f.jsxs)("form",{onSubmit:m(async()=>{l.length?await c(l):i("Please select at least one file.")}),children:[(0,f.jsx)("h3",{className:"text-sm font-semibold text-gray-100 mb-2",children:"Upload document"}),(0,f.jsxs)("div",{onDragOver:e=>{e.preventDefault(),n(!0)},onDragLeave:()=>n(!1),onDrop:e=>{e.preventDefault(),n(!1),b(e.dataTransfer.files)},className:"rounded-lg border-2 border-dashed p-4 text-sm bg-gray-800/40 ".concat(t?"border-blue-400 bg-gray-800/70":"border-gray-700"),children:[(0,f.jsx)("p",{className:"text-gray-300 mb-2",children:"Drag & drop PDF / DOCX / TXT here"}),(0,f.jsxs)("div",{className:"flex items-center gap-2",children:[(0,f.jsx)("button",{type:"button",onClick:()=>{var t;return null===(t=e.current)||void 0===t?void 0:t.click()},className:"px-3 py-1.5 rounded-md bg-white text-gray-900 text-sm font-medium hover:bg-gray-100",children:"Browse files"}),(0,f.jsx)("span",{className:"text-gray-400 text-xs",children:"Max 5 MB each"})]}),(0,f.jsx)("input",(0,p.A)((0,p.A)({},v),{},{ref:t=>{e.current=t,v.ref(t)},type:"file",accept:".pdf,.txt,.docx,application/pdf,text/plain,application/vnd.openxmlformats-officedocument.wordprocessingml.document",multiple:!0,onChange:e=>b(e.target.files),className:"hidden"})),l.length>0&&(0,f.jsx)("ul",{className:"mt-3 space-y-1 text-gray-2 00 max-h-28 overflow-auto pr-1",children:l.map((e,t)=>(0,f.jsxs)("li",{className:"flex justify-between text-xs",children:[(0,f.jsx)("span",{className:"truncate",children:e.name}),(0,f.jsxs)("span",{className:"text-gray-400 ml-2",children:[(e.size/1024/1024).toFixed(2)," MB"]})]},"".concat(e.name,"-").concat(t)))}),r&&(0,f.jsx)("div",{className:"mt-3 text-xs text-red-400",children:r})]}),(0,f.jsx)("button",{type:"submit",disabled:0===l.length,className:"mt-3 w-full px-3 py-2 rounded-md text-sm font-semibold ".concat(l.length?"bg-blue-500 text-white hover:bg-blue-600":"bg-gray-700 text-gray-400 cursor-not-allowed"),children:"Confirm & Upload"}),l.length>0&&(0,f.jsx)("button",{type:"button",onClick:()=>{o(),d(),e.current&&(e.current.value="")},className:"mt-2 w-full px-3 py-2 rounded-md text-sm bg-gray-800 text-gray-300 hover:bg-gray-700",children:"Clear selection"})]})},v=e=>{let{documents:t,selectedId:n,onSelect:s,onConfirmDelete:l}=e;return(0,f.jsxs)("div",{children:[(0,f.jsx)("h3",{className:"text-sm font-semibold text-gray-100 mb-2",children:"Files"}),0===t.length?(0,f.jsx)("p",{className:"text-gray-400 text-sm",children:"No files yet."}):(0,f.jsx)("ul",{className:"space-y-1 overflow-y-auto max-h-[50vh] pr-1",children:t.map(e=>{return(0,f.jsxs)("li",{className:"flex items-center justify-between px-2 py-1.5 rounded-md cursor-pointer text-sm ".concat(n===e.id?"bg-blue-600 text-white":"hover:bg-gray-800"),children:[(0,f.jsxs)("span",{onClick:()=>s(e.id),className:"flex-1 flex items-center gap-2 truncate pr-2",title:e.name,children:[(0,f.jsx)("span",{className:"shrink-0",children:(t=e,/pdf/i.test(t.type)||/\.pdf$/i.test(t.name)?"\ud83d\udcc4":/docx/i.test(t.type)||/\.docx$/i.test(t.name)?"\ud83d\udcdd":"\ud83d\udcc3")}),(0,f.jsx)("span",{className:"truncate",children:e.name})]}),(0,f.jsx)("button",{onClick:t=>{t.stopPropagation(),l(e)},className:"p-1 rounded hover:bg-gray-700",title:"Delete",children:(0,f.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,f.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},e.id);var t})})]})};var b=n(7633);const y=e=>{let{dataURL:t,className:n="h-[70vh] overflow-auto rounded border bg-white p-4"}=e;const l=(0,s.useRef)(null),[r,a]=(0,s.useState)("");return(0,s.useEffect)(()=>{(async()=>{if(a(""),l.current&&t){l.current.innerHTML="Loading\u2026";try{const e=function(e){const t=e.split(",")[1]||e,n=atob(t),s=n.length,l=new Uint8Array(s);for(let r=0;r<s;r++)l[r]=n.charCodeAt(r);return l.buffer}(t),{value:n}=await b.convertToHtml({arrayBuffer:e},{includeDefaultStyleMap:!0,styleMap:["p[style-name='Heading 1'] => h1:fresh","p[style-name='Heading 2'] => h2:fresh"]});l.current.innerHTML=n||'<div style="color:#6b7280">Empty document</div>'}catch(e){console.error(e),a("Failed to render DOCX."),l.current.innerHTML=""}}})()},[t]),(0,f.jsxs)("div",{className:n,children:[r&&(0,f.jsx)("div",{className:"mb-2 text-sm text-red-600",children:r}),(0,f.jsx)("div",{ref:l,className:"prose max-w-none p-4"})]})};var j=n(7893);const w=()=>(0,f.jsx)(j.pp,{title:"Add your first document",description:(0,f.jsxs)(f.Fragment,{children:["Use the ",(0,f.jsx)("span",{className:"font-medium",children:"\u201cUpload Document\u201d"})," card in the left sidebar menu to add files. We\u2019ll store them locally and show a preview here."]}),bullets:[(0,f.jsxs)(f.Fragment,{children:["Supported types: ",(0,f.jsx)("code",{children:"PDF"}),", ",(0,f.jsx)("code",{children:"DOCX"}),", ",(0,f.jsx)("code",{children:"TXT"})," ","(max 5\xa0MB each)."]}),"Your documents will appear in the list on the left.","Click a document to open its preview on this page."]}),N=e=>{var t;let{doc:n}=e;if(!n)return(0,f.jsx)(w,{});const s=/pdf/i.test(n.type)||/\.pdf$/i.test(n.name),l=/text\/plain/i.test(n.type)||/\.txt$/i.test(n.name),r=/docx/i.test(n.type)||/\.docx$/i.test(n.name);return(0,f.jsxs)("div",{className:"rounded-lg border bg-white p-4",children:[(0,f.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,f.jsx)("h2",{className:"text-lg font-semibold truncate pr-4",children:n.name}),(0,f.jsxs)("div",{className:"text-xs text-gray-500",children:[(n.size/1024/1024).toFixed(2)," MB"]})]}),s&&n.dataURL&&(0,f.jsx)("iframe",{title:n.name,src:n.dataURL,className:"w-full h-[70vh] rounded border"}),l&&(0,f.jsx)("pre",{className:"w-full h-[70vh] overflow-auto bg-gray-50 p-4 rounded text-sm whitespace-pre-wrap",children:null!==(t=n.text)&&void 0!==t?t:"(empty file)"}),r&&n.dataURL&&(0,f.jsx)(y,{dataURL:n.dataURL,className:"h-[70vh] overflow-auto rounded border bg-white"}),r&&!n.dataURL&&(0,f.jsx)("div",{className:"p-6 text-center text-gray-600",children:"Preview not available."})]})};var C=n(3536);const k=()=>{const{documents:e,selectedId:t}=x((0,l.k)(e=>({documents:e.items,selectedId:e.selectedId}))),n=x(e=>e.setSelected),r=x(e=>e.deleteDocument),a=(0,s.useMemo)(()=>{var n;return null!==(n=e.find(e=>e.id===t))&&void 0!==n?n:null},[e,t]),[o,i]=(0,s.useState)(!1),[d,c]=(0,s.useState)(!1),[u,m]=(0,s.useState)(null);(0,s.useEffect)(()=>{const e=(0,C.debounce)(e=>{console.log("app:toggleSidebar triggered at:",(new Date).toISOString()),i(e=>!e)},300);return window.addEventListener("app:toggleSidebar",e),()=>{e.cancel(),window.removeEventListener("app:toggleSidebar",e)}},[]);return(0,f.jsx)("div",{className:"h-screen w-full flex flex-col bg-gray-50",children:(0,f.jsx)("div",{className:"flex-1 min-h-0 w-full",children:(0,f.jsxs)("div",{className:"relative h-full w-full flex overflow-hidden",children:[(0,f.jsx)("div",{onClick:()=>i(!1),className:"lg:hidden fixed inset-0 z-20 bg-black/40 transition-opacity duration-300 ".concat(o?"opacity-100":"opacity-0 pointer-events-none")}),(0,f.jsx)("aside",{"aria-label":"Documents sidebar",className:"\n              fixed lg:static inset-y-0 left-0 z-30 w-64 bg-gray-900 text-white\n              border-r border-gray-800 overflow-y-auto shrink-0\n              transform transition-transform duration-300 ease-in-out\n              ".concat(o?"translate-x-0":"-translate-x-full","\n              lg:translate-x-0 lg:transform-none\n            "),children:(0,f.jsxs)("div",{className:"h-full p-4 space-y-6",children:[(0,f.jsx)(g,{}),(0,f.jsx)(v,{documents:e,selectedId:t,onSelect:e=>{n(e),window.innerWidth<1024&&i(!1)},onConfirmDelete:e=>{m(e),c(!0)}})]})}),(0,f.jsxs)("main",{className:"flex-1 min-w-0 h-full overflow-auto",children:[(0,f.jsxs)("div",{className:"h-full flex flex-col",children:[a&&(0,f.jsx)("div",{className:"bg-white border-b",children:(0,f.jsx)("div",{className:"mx-auto w-full max-w-7xl flex items-center justify-between px-6 py-4",children:(0,f.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Documents"})})}),(0,f.jsx)("div",{className:"flex-1 overflow-auto",children:(0,f.jsx)(N,{doc:a})})]}),(0,f.jsxs)(j.aF,{isOpen:d,onClose:()=>{c(!1),m(null)},title:"Delete document?",children:[(0,f.jsx)("p",{className:"text-gray-700",children:"Are you sure you want to delete \u201c".concat((null===u||void 0===u?void 0:u.name)||"this file","\u201d? This action cannot be undone.")}),(0,f.jsxs)("div",{className:"flex justify-between space-x-3 mt-6",children:[(0,f.jsx)("button",{onClick:()=>{c(!1),m(null)},className:"px-4 py-2 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300",children:"Cancel"}),(0,f.jsx)("button",{onClick:()=>{u&&(r(u),t===u.id&&n(null),c(!1),m(null))},className:"px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700",children:"Delete"})]})]})]})]})})})};function S(){return(0,f.jsx)(k,{})}},7002:(e,t,n)=>{n.d(t,{A:()=>l});var s=n(9930);function l(){const e=(0,s.vw)();if(!e)throw new Error("useProjectHub must be used within ProjectHubProvider");return e}},7893:(e,t,n)=>{n.d(t,{pp:()=>r,aF:()=>s.A});var s=n(6041),l=(n(5107),n(4024),n(9453),n(5043),n(7002),n(579));n(3198),n(1497);const r=e=>{let{title:t,description:n,bullets:s,action:r,className:a="rounded-xl border bg-white p-8"}=e;return(0,l.jsxs)("div",{className:a,children:[(0,l.jsx)("h2",{className:"text-2xl font-semibold text-gray-900",children:t}),n&&(0,l.jsx)("div",{className:"mt-2 text-gray-600 text-sm",children:n}),null!==s&&void 0!==s&&s.length?(0,l.jsx)("ul",{className:"mt-3 list-disc pl-5 space-y-1 text-sm text-gray-700",children:s.map((e,t)=>(0,l.jsx)("li",{children:e},t))}):null,r&&(0,l.jsx)("div",{className:"mt-4",children:r})]})}},9453:(e,t,n)=>{n.d(t,{A:()=>r});var s=n(5043),l=n(579);const r=e=>{let{value:t,className:n}=e;const[r,a]=(0,s.useState)(!1);return(0,l.jsxs)("div",{className:["inline-flex items-center gap-2",n].join(" "),children:[(0,l.jsx)("code",{className:"rounded bg-gray-100 px-2 py-1",children:r?t:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"}),(0,l.jsx)("button",{type:"button",onClick:()=>a(e=>!e),className:"text-xs rounded border px-2 py-1 hover:bg-gray-50",children:r?"Hide":"Show"})]})}},9930:(e,t,n)=>{n.d(t,{Yt:()=>m,vw:()=>u});var s=n(9379),l=n(5043),r=n(8424),a=n(579);const o="projects",i="selectedProjectId";function d(e){r.IG.set(r.Cx,o,e)}const c=(0,l.createContext)(void 0),u=()=>(0,l.useContext)(c);function m(e){let{children:t}=e;const[n,u]=(0,l.useState)([]),[m,x]=(0,l.useState)(null),p=()=>u(r.IG.get(r.Cx,o,[]));(0,l.useEffect)(()=>{p(),x(r.IG.get(r.Cx,i,null))},[]),(0,l.useEffect)(()=>{m?r.IG.set(r.Cx,i,m):r.IG.remove(r.Cx,i)},[m]);const h=(0,l.useMemo)(()=>n.find(e=>e.id===m)||null,[n,m]),f={projects:n,selected:h,selectedId:m,setSelectedId:x,selectProject:e=>x(e),addProject:e=>{const t=(e||"").trim();if(!t)return null;if(n.some(e=>e.name.toLowerCase()===t.toLowerCase()))return null;const s="".concat(t.toLowerCase().replace(/\s+/g,"-"),"-").concat(Date.now()),l={id:s,name:t,sections:{}},r=[...n,l];return u(r),d(r),x(s),l},deleteProject:e=>{const t=n.filter(t=>t.id!==e);u(t),d(t),m===e&&x(null)},updateSection:(e,t)=>{if(!m)return;const l=n.map(n=>n.id!==m?n:(0,s.A)((0,s.A)({},n),{},{sections:(0,s.A)((0,s.A)({},n.sections||{}),{},{[e]:t})}));u(l),d(l)},refresh:p};return(0,a.jsx)(c.Provider,{value:f,children:t})}}}]);
//# sourceMappingURL=103.58c0e365.chunk.js.map